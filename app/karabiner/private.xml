<?xml version="1.0"?>
<root>
  <appdef>
    <appname>MACVIM</appname>
    <equal>org.vim.MacVim</equal>
  </appdef>

  <modifierdef>PRIVATE_SUPER_MODE</modifierdef>

  <replacementdef>
    <replacementname>EMACS_MODE_IGNORE_APPS</replacementname>
    <replacementvalue>
      ECLIPSE,
      EMACS,
      REMOTEDESKTOPCONNECTION,
      TERMINAL,
      VI,
      MACVIM,
      VIRTUALMACHINE,
      X11,
    </replacementvalue>
  </replacementdef>

  <list>
    <item>
      <name>Cmd-' to toggle open finder</name>
      <identifier>private.open_finder</identifier>

      <block>
        <not>FINDER</not>
        <autogen>
          __KeyToKey__
          KeyCode::QUOTE, VK_COMMAND | ModifierFlag::NONE,
          KeyCode::VK_OPEN_URL_APP_Finder
        </autogen>
      </block>
      <block>
        <only>FINDER</only>
        <autogen>
          __KeyToKey__
          KeyCode::QUOTE, VK_COMMAND | ModifierFlag::NONE,
          KeyCode::H, VK_COMMAND
        </autogen>
      </block>
    </item>

    <item>
      <name>Leave InsMode with EISUU (MacVim)</name>
      <identifier>private.app_macvim_esc_with_eisuu</identifier>
      <only>MACVIM</only>
      <autogen>
        --KeyToKey--
        KeyCode::ESCAPE,
        KeyCode::ESCAPE, KeyCode::JIS_EISUU
      </autogen>
      <autogen>
        --KeyToKey--
        KeyCode::C, VK_CONTROL,
        KeyCode::C, VK_CONTROL, KeyCode::JIS_EISUU
      </autogen>
      <autogen>
        --KeyToKey--
        KeyCode::BRACKET_LEFT, VK_CONTROL,
        KeyCode::BRACKET_LEFT, VK_CONTROL, KeyCode::JIS_EISUU
      </autogen>
    </item>

    <item>
      <name>Ctrl-; to toggle input source</name>
      <identifier>private.ctrl_semicolon_toggle_input_source</identifier>

      <block>
        <inputsource_only>JAPANESE</inputsource_only>
        <autogen>
          --KeyToKey--
          KeyCode::SEMICOLON, VK_CONTROL | ModifierFlag::NONE,
          KeyCode::JIS_EISUU
        </autogen>
        <autogen>
          --KeyToKey--
          KeyCode::SEMICOLON, ModifierFlag::NONE,
          KeyCode::JIS_EISUU
        </autogen>
      </block>
      <block>
        <inputsource_not>JAPANESE</inputsource_not>
        <autogen>
          --KeyToKey--
          KeyCode::SEMICOLON, VK_CONTROL | ModifierFlag::NONE,
          KeyCode::JIS_KANA
        </autogen>
      </block>
    </item>

    <item>
      <name>Super mode</name>
      <identifier vk_config="true">private.super_mode</icentifier>

      <appendix>A+H: Move to left space</appendix>
      <appendix>A+L: Move to right space</appendix>
      <appendix>A+J: Switch to next application</appendix>
      <appendix>A+K: Switch to previous application</appendix>
      <appendix>A+N: Switch to next window</appendix>
      <appendix>A+B: Switch to previous window</appendix>

      <block>
        <modifier_not>
          ModifierFlag::COMMAND_L,
          ModifierFlag::COMMAND_R,
          ModifierFlag::CONTROL_L,
          ModifierFlag::CONTROL_R,
          ModifierFlag::FN,
          ModifierFlag::OPTION_L,
          ModifierFlag::OPTION_R,
          ModifierFlag::SHIFT_L,
          ModifierFlag::SHIFT_R,
        </modifier_not>

        <autogen>
          __KeyOverlaidModifier__
          KeyCode::A,

          @begin
          KeyCode::VK_CONFIG_FORCE_ON_private_super_mode,
          KeyCode::VK_MODIFIER_PRIVATE_SUPER_MODE,
          @end

          @begin
          KeyCode::A,
          @end
        </autogen>
      </block>

      <block>
        <modifier_only>ModifierFlag::PRIVATE_SUPER_MODE</modifier_only>

        <autogen>
          __BlockUntilKeyUp__
          KeyCode::A
        </autogen>

        <autogen>
          __KeyToKey__
          KeyCode::H,
          KeyCode::CURSOR_LEFT, ModifierFlag::CONTROL_L,
          ModifierFlag::PRIVATE_SUPER_MODE,
        </autogen>
        <autogen>
          __KeyToKey__
          KeyCode::L,
          KeyCode::CURSOR_RIGHT, ModifierFlag::CONTROL_L,
          ModifierFlag::PRIVATE_SUPER_MODE,
        </autogen>
        <autogen>
          __KeyToKey__
          KeyCode::J,
          KeyCode::TAB, ModifierFlag::COMMAND_L,
          ModifierFlag::PRIVATE_SUPER_MODE,
        </autogen>
        <autogen>
          __KeyToKey__
          KeyCode::K,
          KeyCode::TAB, ModifierFlag::COMMAND_L | ModifierFlag::SHIFT_L,
          ModifierFlag::PRIVATE_SUPER_MODE,
        </autogen>

        <autogen>
          __KeyToKey__
          KeyCode::N,
          KeyCode::BACKQUOTE, ModifierFlag::COMMAND_L,
          ModifierFlag::PRIVATE_SUPER_MODE,
        </autogen>
        <autogen>
          __KeyToKey__
          KeyCode::B,
          KeyCode::BACKQUOTE, ModifierFlag::COMMAND_L | ModifierFlag::SHIFT_L,
          ModifierFlag::PRIVATE_SUPER_MODE,
        </autogen>

        <autogen>
          __DropAllKeys__
          ModifierFlag::PRIVATE_SUPER_MODE,

          Option::DROPALLKEYS_DROP_KEY,
        </autogen>
      </block>
    </item>

    <item>
      <name>Tab moves</name>
      <identifier>private.tab_moves</identifier>
      <not>{{EMACS_MODE_IGNORE_APPS}}</not>

      <appendix>Control-S Control-N: Move to next tab</appendix>
      <appendix>Control-S Control-B: Move to previous tab</appendix>

      <autogen>
        __SimultaneousKeyPresses__
        KeyCode::S, KeyCode::N, ModifierFlag::CONTROL_L,
        KeyCode::BRACKET_RIGHT, ModifierFlag::COMMAND_L | ModifierFlag::SHIFT_L,
      </autogen>
      <autogen>
        __SimultaneousKeyPresses__
        KeyCode::S, KeyCode::B, ModifierFlag::CONTROL_L,
        KeyCode::BRACKET_LEFT, ModifierFlag::COMMAND_L | ModifierFlag::SHIFT_L,
      </autogen>
    </item>

  </list>
</root>
