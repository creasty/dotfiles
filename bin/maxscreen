#!/usr/bin/env bash

set -eu
set -o pipefail

if ! command -v 'displayplacer' > /dev/null 2>&1; then
  # macOS command line utility to configure multi-display resolutions and arrangements.
  brew install jakehilborn/jakehilborn/displayplacer
fi

LIST="$(displayplacer list)"
CURRENT_SCREEN_ID="$(sed -n -E 's/^Persistent screen id: ([0-9A-F-]+)/\1/p;10q' <<< "$LIST")"
PHYSICAL_RESOLUTION="$(sed -n -E 's/^Resolution: ([0-9]+x[0-9]+)/\1/p;10q' <<< "$LIST")"

( set -x; displayplacer "id:$CURRENT_SCREEN_ID res:$PHYSICAL_RESOLUTION" & )
