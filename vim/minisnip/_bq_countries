create temp function countries() returns array<struct<code string, rank int64>> as ((
  [
    struct('JP' as code, 0 as rank),
    struct('SG' as code, 1 as rank),
    struct('HK' as code, 2 as rank),
    struct('DE' as code, 3 as rank)
  ]
));

create temp function match_country(cd string) returns bool as ((
  cd in ('JP', 'SG', 'HK', 'DE')
));

create temp function match_country_code(cd string, name string) returns bool as ((
  concat(cd, ':', name) in (
    'JP:japan',
    'SG:singapore',
    'HK:hong_kong',
    'DE:germany'
  )
));{{--}}
